<mvc:View
    controllerName="salesorder.ui5.app.controller.SalesOrderList"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:card="sap.f.cards"
    xmlns:layout="sap.ui.layout"
    xmlns:core="sap.ui.core"
    displayBlock="true">
    <Page
        id="salesOrderListPage"
        title="{i18n>salesOrderListTitle}"
        class="sapUiResponsiveContentPadding">
        <headerContent>
            <Button
                id="refreshButton"
                icon="sap-icon://refresh"
                press=".onRefresh"
                tooltip="{i18n>refreshTooltip}"
                type="Emphasized"/>
        </headerContent>
        <content>
            <!-- Main VBox wrapper to stack sections vertically -->
            <VBox id="mainWrapper" width="100%">
                <!-- Top Section: KPI Grid (Left) and Filters (Right) -->
                <HBox id="topSection" class="sapUiSmallMargin" width="100%">
                <!-- Left: KPI Section in 2x2 Grid -->
                <VBox id="kpiSection" class="kpiSectionContainer">
                    <layout:Grid id="kpiGrid" defaultSpan="XL6 L6 M6 S12" hSpacing="0.5" vSpacing="0.5" class="kpiGridContainer">
                        <!-- Total Orders KPI -->
                        <GenericTile
                            id="totalOrdersTile"
                            class="kpiTile kpiTileBlue"
                            header="Total Orders"
                            subheader="Active Sales Orders"
                            press=".onKPIPress">
                            <tileContent>
                                <TileContent id="totalOrdersContent">
                                    <content>
                                        <NumericContent
                                            id="totalOrdersNumeric"
                                            value="{viewModel>/totalOrders}"
                                            icon="sap-icon://sales-order"
                                            withMargin="false"/>
                                    </content>
                                </TileContent>
                            </tileContent>
                        </GenericTile>

                        <!-- Total Revenue KPI -->
                        <GenericTile
                            id="totalRevenueTile"
                            class="kpiTile kpiTileGreen"
                            header="Total Revenue"
                            subheader="Overall Sales Value"
                            press=".onKPIPress">
                            <tileContent>
                                <TileContent id="totalRevenueContent">
                                    <content>
                                        <NumericContent
                                            id="totalRevenueNumeric"
                                            value="{viewModel>/totalRevenue}"
                                            scale="M"
                                            icon="sap-icon://money-bills"
                                            withMargin="false"/>
                                    </content>
                                </TileContent>
                            </tileContent>
                        </GenericTile>

                        <!-- Average Order Value KPI -->
                        <GenericTile
                            id="avgOrderValueTile"
                            class="kpiTile kpiTileOrange"
                            header="Avg Order Value"
                            subheader="Per Order"
                            press=".onKPIPress">
                            <tileContent>
                                <TileContent id="avgOrderValueContent">
                                    <content>
                                        <NumericContent
                                            id="avgOrderValueNumeric"
                                            value="{viewModel>/avgOrderValue}"
                                            icon="sap-icon://bar-chart"
                                            withMargin="false"/>
                                    </content>
                                </TileContent>
                            </tileContent>
                        </GenericTile>

                        <!-- Active Customers KPI -->
                        <GenericTile
                            id="totalCustomersTile"
                            class="kpiTile kpiTilePurple"
                            header="Customers"
                            subheader="Unique Customers"
                            press=".onKPIPress">
                            <tileContent>
                                <TileContent id="totalCustomersContent">
                                    <content>
                                        <NumericContent
                                            id="totalCustomersNumeric"
                                            value="{viewModel>/totalCustomers}"
                                            icon="sap-icon://customer"
                                            withMargin="false"/>
                                    </content>
                                </TileContent>
                            </tileContent>
                        </GenericTile>
                    </layout:Grid>
                </VBox>

                <!-- Right: Filter Panel -->
                <VBox id="filterPanelContainer" class="filterPanelContainer">
                    <Panel id="filterPanel" headerText="Filters" expandable="true" expanded="true" width="100%">
                <content>
                    <VBox id="filterBox" class="sapUiSmallMargin">
                        <HBox id="filterRow1" class="sapUiTinyMarginBottom">
                            <VBox id="salesOrderFilterBox" class="sapUiSmallMarginEnd" width="220px">
                                <Label id="salesOrderLabel" text="Sales Order Number"/>
                                <Input id="filterSalesOrder" placeholder="Enter Sales Order" submit=".onFilterApply" showValueHelp="true" valueHelpRequest=".onValueHelpSalesOrder"/>
                            </VBox>
                            <VBox id="customerFilterBox" class="sapUiSmallMarginEnd" width="220px">
                                <Label id="customerLabel" text="Customer"/>
                                <Input id="filterCustomer" placeholder="Enter Customer" submit=".onFilterApply" showValueHelp="true" valueHelpRequest=".onValueHelpCustomer"/>
                            </VBox>
                            <VBox id="createdByFilterBox" class="sapUiSmallMarginEnd" width="220px">
                                <Label id="createdByLabel" text="Created By"/>
                                <Input id="filterCreatedBy" placeholder="Enter User" submit=".onFilterApply" showValueHelp="true" valueHelpRequest=".onValueHelpCreatedBy"/>
                            </VBox>
                            <VBox id="salesOrgFilterBox" class="sapUiSmallMarginEnd" width="220px">
                                <Label id="salesOrgLabel" text="Sales Organization"/>
                                <Input id="filterSalesOrg" placeholder="Enter Sales Org" submit=".onFilterApply" showValueHelp="true" valueHelpRequest=".onValueHelpSalesOrg"/>
                            </VBox>
                        </HBox>
                        <HBox id="filterRow2" class="sapUiTinyMarginBottom">
                            <VBox id="createdOnFilterBox" class="sapUiSmallMarginEnd" width="200px">
                                <Label id="createdOnLabel" text="Created On From"/>
                                <DatePicker id="filterCreatedOnFrom" placeholder="Select Date" change=".onFilterApply"/>
                            </VBox>
                            <VBox id="createdOnToFilterBox" class="sapUiSmallMarginEnd" width="200px">
                                <Label id="createdOnToLabel" text="Created On To"/>
                                <DatePicker id="filterCreatedOnTo" placeholder="Select Date" change=".onFilterApply"/>
                            </VBox>
                            <VBox id="orderTypeFilterBox" class="sapUiSmallMarginEnd" width="200px">
                                <Label id="orderTypeLabel" text="Order Type"/>
                                <Select id="filterOrderType" change=".onFilterApply">
                                    <items>
                                        <core:Item key="" text="All"/>
                                        <core:Item key="CBIC" text="CBIC"/>
                                        <core:Item key="ZOR" text="ZOR"/>
                                    </items>
                                </Select>
                            </VBox>
                            <VBox id="filterButtonBox" class="sapUiSmallMarginEnd" justifyContent="End">
                                <HBox>
                                    <Button id="applyFilterBtn" text="Apply Filters" press=".onFilterApply" type="Emphasized" class="sapUiTinyMarginEnd"/>
                                    <Button id="clearFilterBtn" text="Clear" press=".onFilterClear"/>
                                </HBox>
                            </VBox>
                        </HBox>
                    </VBox>
                </content>
            </Panel>
                </VBox>
            </HBox>

            <!-- Table Section - Full Width Below -->
            <VBox id="tableContainer" class="sapUiSmallMargin tableSection">
                    <Table
                        id="salesOrderTable"
                        inset="false"
                        growing="true"
                        growingScrollToLoad="true"
                        growingThreshold="20"
                        width="100%"
                        items="{
                            path: '/A_SalesOrder',
                            parameters: {
                                $select: 'SalesOrder,SoldToParty,SalesOrderDate,TotalNetAmount,TransactionCurrency,SalesOrderType,CreatedByUser,CreationDate,SalesOrganization,DistributionChannel,PurchaseOrderByCustomer',
                                $top: '50',
                                $inlinecount: 'allpages'
                            }
                        }">
                        <headerToolbar>
                            <OverflowToolbar id="tableToolbar">
                                <Title id="tableTitle" text="{i18n>salesOrderTableTitle} ({viewModel>/totalOrders})"/>
                                <ToolbarSpacer id="toolbarSpacer"/>
                                <SearchField
                                    id="searchField"
                                    width="50%"
                                    search=".onSearch"
                                    placeholder="{i18n>searchPlaceholder}"/>
                            </OverflowToolbar>
                        </headerToolbar>
                <columns>
                    <Column id="orderIdColumn" width="10%" hAlign="Center">
                        <Text text="Order #" class="tableColumnHeader"/>
                    </Column>
                    <Column id="customerColumn" width="22%">
                        <Text text="Customer" class="tableColumnHeader"/>
                    </Column>
                    <Column id="orderDateColumn" hAlign="Center" width="10%">
                        <Text text="Order Date" class="tableColumnHeader"/>
                    </Column>
                    <Column id="createdByColumn" width="12%">
                        <Text text="Created By" class="tableColumnHeader"/>
                    </Column>
                    <Column id="salesOrgColumn" hAlign="Center" width="10%">
                        <Text text="Sales Org" class="tableColumnHeader"/>
                    </Column>
                    <Column id="amountColumn" hAlign="End" width="12%">
                        <Text text="Total Amount" class="tableColumnHeader"/>
                    </Column>
                    <Column id="orderTypeColumn" hAlign="Center" width="10%">
                        <Text text="Type" class="tableColumnHeader"/>
                    </Column>
                    <Column id="poColumn" width="10%">
                        <Text text="PO Number" class="tableColumnHeader"/>
                    </Column>
                    <Column id="statusColumn" hAlign="Center" width="4%">
                        <Text text="" class="tableColumnHeader"/>
                    </Column>
                </columns>
                <items>
                    <ColumnListItem
                        type="Navigation"
                        press=".onItemPress"
                        class="modernListItem">
                        <cells>
                            <!-- Order Number with Badge -->
                            <VBox alignItems="Center" justifyContent="Center">
                                <HBox alignItems="Center" class="orderBadge">
                                    <core:Icon src="sap-icon://document-text" color="#667eea" size="0.9rem" class="sapUiTinyMarginEnd"/>
                                    <Text text="{SalesOrder}" class="orderNumberText"/>
                                </HBox>
                            </VBox>

                            <!-- Customer with Icon and Name -->
                            <VBox>
                                <HBox alignItems="Center" class="sapUiTinyMarginBottom">
                                    <core:Icon src="sap-icon://customer" color="#0070f2" size="0.9rem" class="sapUiTinyMarginEnd"/>
                                    <Text text="{SoldToParty}" class="customerIdText"/>
                                </HBox>
                                <Text text="{SoldToParty}" class="customerNamePlaceholder"/>
                            </VBox>

                            <!-- Order Date with Calendar Icon -->
                            <VBox alignItems="Center" justifyContent="Center">
                                <core:Icon src="sap-icon://appointment-2" color="#28a745" size="1rem" class="sapUiTinyMarginBottom"/>
                                <Text text="{
                                    path: 'SalesOrderDate',
                                    type: 'sap.ui.model.type.Date',
                                    formatOptions: {
                                        pattern: 'dd/MM/yyyy'
                                    }
                                }" class="dateText"/>
                            </VBox>

                            <!-- Created By with User Icon -->
                            <VBox>
                                <HBox alignItems="Center" class="sapUiTinyMarginBottom">
                                    <core:Icon src="sap-icon://employee" color="#9b59b6" size="0.8rem" class="sapUiTinyMarginEnd"/>
                                    <Text text="{CreatedByUser}" class="createdByText"/>
                                </HBox>
                                <Text text="{
                                    path: 'CreationDate',
                                    type: 'sap.ui.model.type.Date',
                                    formatOptions: {
                                        pattern: 'dd/MM/yyyy'
                                    }
                                }" class="creationDateSubtext"/>
                            </VBox>

                            <!-- Sales Organization with Badge -->
                            <VBox alignItems="Center">
                                <HBox class="salesOrgBadge" alignItems="Center">
                                    <core:Icon src="sap-icon://org-chart" color="#ff9800" size="0.8rem" class="sapUiTinyMarginEnd"/>
                                    <Text text="{SalesOrganization}" class="salesOrgText"/>
                                </HBox>
                            </VBox>

                            <!-- Amount with Progress Indicator -->
                            <VBox alignItems="End">
                                <ObjectNumber
                                    number="{
                                        path: 'TotalNetAmount',
                                        type: 'sap.ui.model.type.Float',
                                        formatOptions: {
                                            maxFractionDigits: 2,
                                            minFractionDigits: 2
                                        }
                                    }"
                                    unit="{TransactionCurrency}"
                                    state="{= ${TotalNetAmount} > 10000 ? 'Success' : ${TotalNetAmount} > 5000 ? 'Warning' : 'Error' }"
                                    class="amountNumberLarge"/>
                                <HBox class="amountBar">
                                    <HBox class="{= ${TotalNetAmount} > 10000 ? 'amountBarFillHigh' : ${TotalNetAmount} > 5000 ? 'amountBarFillMedium' : 'amountBarFillLow' }"/>
                                </HBox>
                            </VBox>

                            <!-- Order Type Badge -->
                            <VBox alignItems="Center">
                                <HBox class="orderTypeBadge" alignItems="Center">
                                    <core:Icon src="sap-icon://tag" color="#e91e63" size="0.7rem" class="sapUiTinyMarginEnd"/>
                                    <Text text="{SalesOrderType}" class="orderTypeText"/>
                                </HBox>
                            </VBox>

                            <!-- PO Number -->
                            <VBox>
                                <HBox alignItems="Center">
                                    <core:Icon src="sap-icon://cart" color="#3498db" size="0.75rem" class="sapUiTinyMarginEnd"/>
                                    <Text text="{= ${PurchaseOrderByCustomer} || 'N/A' }" class="poNumberText"/>
                                </HBox>
                            </VBox>

                            <!-- Status Icon -->
                            <VBox alignItems="Center" justifyContent="Center">
                                <core:Icon src="sap-icon://status-positive" color="#28a745" size="1.2rem" class="statusIcon"/>
                            </VBox>
                        </cells>
                    </ColumnListItem>
                </items>
                    </Table>
            </VBox>
            </VBox>
        </content>
    </Page>
</mvc:View>
